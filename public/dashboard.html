<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Bot - YÃ¶netim Paneli</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #25D366;
            --secondary-color: #128C7E;
            --dark-color: #075E54;
            --light-bg: #f0f2f5;
        }
        
        body { background: var(--light-bg); font-family: 'Segoe UI', Tahoma, sans-serif; }
        
        .sidebar {
            background: linear-gradient(180deg, var(--dark-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            position: fixed;
            width: 280px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }
        
        .logo-section { padding: 25px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .logo-section h4 { color: white; margin: 10px 0 5px; font-weight: 600; }
        .logo-section small { color: rgba(255,255,255,0.7); }
        
        .nav-label { color: rgba(255,255,255,0.5); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; padding: 15px 25px 8px; }
        
        .sidebar .nav-link {
            color: rgba(255,255,255,0.85);
            padding: 12px 25px;
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .sidebar .nav-link:hover { background: rgba(255,255,255,0.1); color: white; }
        .sidebar .nav-link.active { background: rgba(255,255,255,0.15); color: white; border-left-color: var(--primary-color); }
        .sidebar .nav-link i { font-size: 1.2rem; width: 24px; }
        
        .status-footer { position: absolute; bottom: 0; width: 100%; padding: 20px; background: rgba(0,0,0,0.2); }
        .status-dot { width: 12px; height: 12px; border-radius: 50%; }
        .status-dot.online { background: #00ff00; box-shadow: 0 0 10px #00ff00; }
        .status-dot.offline { background: #ff4444; }
        .status-dot.connecting { background: #ffaa00; animation: pulse 1s infinite; }
        @keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:0.5; } }
        
        .main-content { margin-left: 280px; padding: 30px; min-height: 100vh; }
        .page-header h2 { color: var(--dark-color); font-weight: 600; margin-bottom: 5px; }
        .page-header p { color: #666; margin: 0 0 25px; }
        
        .card { border: none; border-radius: 16px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); margin-bottom: 24px; }
        .card-header { background: white; border-bottom: 1px solid #eee; padding: 18px 24px; font-weight: 600; display: flex; align-items: center; gap: 10px; }
        .card-header i { color: var(--primary-color); }
        .card-body { padding: 24px; }
        
        .help-box { background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-left: 4px solid var(--primary-color); border-radius: 8px; padding: 16px 20px; margin-bottom: 20px; }
        .help-box h6 { color: var(--dark-color); margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .help-box p, .help-box ul { color: #555; margin: 0; font-size: 0.9rem; }
        .help-box ul { margin: 10px 0 0; padding-left: 20px; }
        
        .stat-card { border-radius: 16px; padding: 24px; color: white; position: relative; overflow: hidden; }
        .stat-card::before { content: ''; position: absolute; top: -50%; right: -50%; width: 100%; height: 200%; background: rgba(255,255,255,0.1); transform: rotate(30deg); }
        .stat-card.green { background: linear-gradient(135deg, #25D366, #128C7E); }
        .stat-card.purple { background: linear-gradient(135deg, #667eea, #764ba2); }
        .stat-card.orange { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .stat-card.blue { background: linear-gradient(135deg, #4facfe, #00f2fe); }
        .stat-number { font-size: 2.5rem; font-weight: 700; }
        .stat-label { opacity: 0.9; font-size: 0.9rem; }
        .stat-icon { position: absolute; right: 20px; top: 50%; transform: translateY(-50%); font-size: 4rem; opacity: 0.2; }
        
        .connection-option { cursor: pointer; transition: all 0.3s; }
        .connection-option:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .connection-option .card-body { padding: 1.5rem; }
        .connection-option i { transition: color 0.3s; }
        .connection-option:hover i { transform: scale(1.1); }
        
        .step-item { display: flex; align-items: flex-start; gap: 15px; margin-bottom: 15px; }
        .step-number { width: 32px; height: 32px; background: var(--primary-color); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; flex-shrink: 0; }
        .step-content h6 { margin: 0 0 5px; color: #333; }
        .step-content p { margin: 0; color: #666; font-size: 0.9rem; }
        
        .message-list { max-height: 500px; overflow-y: auto; }
        .message-item { padding: 12px 16px; border-bottom: 1px solid #eee; cursor: pointer; display: flex; align-items: center; gap: 12px; }
        .message-item:hover { background: #f8f9fa; }
        .message-item.active { background: #e8f5e9; border-left: 3px solid var(--primary-color); }
        .message-item.category { background: #f8f9fa; font-weight: 600; color: var(--dark-color); cursor: default; }
        .message-item .icon { width: 36px; height: 36px; background: #e8f5e9; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary-color); }
        
        .message-editor-area { min-height: 200px; font-family: monospace; font-size: 14px; line-height: 1.6; }
        
        .phone-preview { background: #e5ddd5; border-radius: 20px; padding: 20px; max-height: 300px; overflow-y: auto; }
        .chat-bubble { background: white; border-radius: 8px 8px 8px 0; padding: 12px 16px; max-width: 90%; box-shadow: 0 1px 2px rgba(0,0,0,0.1); white-space: pre-wrap; }
        
        .flow-card { border: 2px solid #e0e0e0; border-radius: 12px; padding: 16px; margin-bottom: 12px; background: white; cursor: pointer; }
        .flow-card:hover { border-color: var(--primary-color); box-shadow: 0 4px 12px rgba(37, 211, 102, 0.15); }
        .flow-number { width: 40px; height: 40px; background: var(--primary-color); color: white; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.2rem; }
        
        .btn-whatsapp { background: var(--primary-color); border: none; color: white; padding: 10px 24px; border-radius: 8px; font-weight: 500; }
        .btn-whatsapp:hover { background: var(--secondary-color); color: white; }
        .btn-outline-whatsapp { border: 2px solid var(--primary-color); color: var(--primary-color); background: white; padding: 8px 20px; border-radius: 8px; }
        .btn-outline-whatsapp:hover { background: var(--primary-color); color: white; }
        
        .form-control, .form-select { border-radius: 8px; padding: 12px 16px; border: 2px solid #e0e0e0; }
        .form-control:focus, .form-select:focus { border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.15); }
        .form-label { font-weight: 500; color: #333; margin-bottom: 8px; }
        .form-text { color: #888; font-size: 0.85rem; }
        
        .log-item { padding: 14px 20px; border-bottom: 1px solid #eee; display: flex; gap: 15px; }
        .log-item:hover { background: #fafafa; }
        .log-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .log-icon.incoming { background: #e3f2fd; color: #1976d2; }
        .log-icon.outgoing { background: #e8f5e9; color: var(--primary-color); }
        
        .toast-container { position: fixed; top: 20px; right: 20px; z-index: 9999; }
        
        .catalog-item { display: flex; align-items: center; gap: 15px; padding: 15px; border: 1px solid #eee; border-radius: 10px; margin-bottom: 10px; }
        .catalog-item i { font-size: 2.5rem; color: #dc3545; }
        
        @media (max-width: 992px) {
            .sidebar { width: 100%; position: relative; min-height: auto; }
            .main-content { margin-left: 0; }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo-section">
            <i class="bi bi-whatsapp" style="font-size: 3rem; color: var(--primary-color);"></i>
            <h4>WhatsApp Bot Panel</h4>
            <small>Ãœye YÃ¶netimi v2.1</small>
        </div>
        
        <div class="nav-section">
            <div class="nav-label">Ana MenÃ¼</div>
            <nav class="nav flex-column">
                <a class="nav-link active" href="#" data-page="connection">
                    <i class="bi bi-phone"></i> WhatsApp BaÄŸlantÄ±sÄ±
                </a>
                <a class="nav-link" href="#" data-page="dashboard">
                    <i class="bi bi-speedometer2"></i> Dashboard
                </a>
            </nav>
            
            <div class="nav-label">Ä°Ã§erik YÃ¶netimi</div>
            <nav class="nav flex-column">
                <a class="nav-link" href="#" data-page="messages">
                    <i class="bi bi-chat-quote"></i> Mesaj Ä°Ã§erikleri
                </a>
                <a class="nav-link" href="#" data-page="flows">
                    <i class="bi bi-diagram-3"></i> MenÃ¼ & AkÄ±ÅŸlar
                </a>
                <a class="nav-link" href="#" data-page="catalogs">
                    <i class="bi bi-file-pdf"></i> PDF Kataloglar
                </a>
            </nav>
            
            <div class="nav-label">Sistem</div>
            <nav class="nav flex-column">
                <a class="nav-link" href="#" data-page="whatsapp-business">
                    <i class="bi bi-cloud-check"></i> WhatsApp Business API
                </a>
                <a class="nav-link" href="#" data-page="settings">
                    <i class="bi bi-gear"></i> Ayarlar
                </a>
                <a class="nav-link" href="#" data-page="logs">
                    <i class="bi bi-journal-text"></i> KonuÅŸma GeÃ§miÅŸi
                    <span class="badge bg-primary ms-auto" id="logCount">0</span>
                </a>
                <a class="nav-link" href="#" onclick="logout()">
                    <i class="bi bi-box-arrow-right"></i> Ã‡Ä±kÄ±ÅŸ Yap
                </a>
            </nav>
        </div>
        
        <div class="status-footer">
            <div class="d-flex align-items-center gap-3 text-white">
                <span class="status-dot offline" id="statusDot"></span>
                <div style="flex: 1;">
                    <div id="statusText" style="font-weight: 600;">BaÄŸlantÄ± Bekleniyor</div>
                    <small style="opacity: 0.7;" id="statusSubtext">Facebook ile baÄŸlanÄ±n</small>
                </div>
                <button id="facebook-connect-btn" class="btn btn-sm" style="background: #1877F2; color: white; border: none;">
                    <i class="bi bi-facebook"></i> BaÄŸlan
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        
        <!-- Connection Page -->
        <div id="page-connection" class="page-content">
            <div class="page-header">
                <h2><i class="bi bi-phone me-2"></i>WhatsApp BaÄŸlantÄ±sÄ±</h2>
                <p>WhatsApp hesabÄ±nÄ±zÄ± bota baÄŸlayÄ±n</p>
            </div>
            
            <div class="row">
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header"><i class="bi bi-link-45deg"></i> WhatsApp BaÄŸlantÄ±sÄ±</div>
                        <div class="card-body">
                            <div id="connectionOptions">
                                <div class="row justify-content-center">
                                    <div class="col-md-10">
                                        <div class="card border text-center h-100" style="border: 3px solid #25D366;">
                                            <div class="card-body p-4">
                                                <i class="bi bi-whatsapp" style="font-size: 4rem; color: #25D366;"></i>
                                                <h3 class="mt-3 mb-2">WhatsApp Business API</h3>
                                                <p class="text-muted mb-4">Meta Developer Console'dan aldÄ±ÄŸÄ±nÄ±z API bilgileriyle baÄŸlanÄ±n</p>
                                                
                                                <div class="d-flex flex-column gap-2 mb-4 text-start" style="font-size: 0.9rem;">
                                                    <div class="d-flex align-items-center">
                                                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                                                        <span>Kendi WhatsApp Business numaranÄ±z</span>
                                                    </div>
                                                    <div class="d-flex align-items-center">
                                                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                                                        <span>GerÃ§ek Interactive Butonlar (mobilde Ã§alÄ±ÅŸÄ±r!)</span>
                                                    </div>
                                                    <div class="d-flex align-items-center">
                                                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                                                        <span>Meta'nÄ±n resmi API'si</span>
                                                    </div>
                                                    <div class="d-flex align-items-center">
                                                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                                                        <span>Profesyonel mesajlaÅŸma desteÄŸi</span>
                                                    </div>
                                                </div>
                                                
                                                <button class="btn btn-success btn-lg w-100" onclick="connectWithTestToken()">
                                                    <i class="bi bi-key me-2"></i>Meta API ile BaÄŸlan
                                                </button>
                                                
                                                <div class="alert alert-info mt-3 mb-0">
                                                    <small>
                                                        <strong>Nereden alÄ±nÄ±r?</strong><br>
                                                        Meta Developer Console â†’ API Testing sayfasÄ±ndan:<br>
                                                        â€¢ Access Token<br>
                                                        â€¢ Phone Number ID<br>
                                                        â€¢ Telefon NumarasÄ±
                                                    </small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- BaÄŸlantÄ± Durumu -->
                                <div class="alert alert-info d-none" id="connectionStatus">
                                    <i class="bi bi-info-circle me-2"></i>
                                    <span id="connectionMessage">BaÄŸlantÄ± kuruluyor...</span>
                                </div>
                                
                                <!-- WhatsApp Hesap SeÃ§imi -->
                                <div id="whatsappAccountSelection" class="d-none mt-4">
                                    <div class="card">
                                        <div class="card-header">
                                            <i class="bi bi-list-ul"></i> WhatsApp Business HesaplarÄ±nÄ±z
                                        </div>
                                        <div class="card-body">
                                            <p class="text-muted">Facebook hesabÄ±nÄ±za baÄŸlÄ± WhatsApp Business hesaplarÄ±nÄ± seÃ§in:</p>
                                            <div id="whatsappAccountList"></div>
                                            <button id="connectSelectedAccount" class="btn btn-success mt-3 d-none">
                                                <i class="bi bi-check-circle me-2"></i>SeÃ§ili HesabÄ± BaÄŸla
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header"><i class="bi bi-list-ol"></i> NasÄ±l BaÄŸlanÄ±lÄ±r?</div>
                        <div class="card-body">
                            <div class="nav nav-tabs" id="connectionTabs">
                                <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#metaApiTab">Meta API BaÄŸlantÄ±sÄ±</button>
                            </div>
                            
                            <div class="tab-content mt-3">
                                <div class="tab-pane fade show active" id="metaApiTab">
                                    <div class="step-item">
                                        <div class="step-number">1</div>
                                        <div class="step-content">
                                            <h6>Meta Developer Console</h6>
                                            <p>developers.facebook.com â†’ Apps â†’ bot Mustafa â†’ API Testing sayfasÄ±na gidin</p>
                                        </div>
                                    </div>
                                    <div class="step-item">
                                        <div class="step-number">2</div>
                                        <div class="step-content">
                                            <h6>Access Token KopyalayÄ±n</h6>
                                            <p>"Generate access token" butonuna tÄ±klayÄ±p token'Ä± kopyalayÄ±n</p>
                                        </div>
                                    </div>
                                    <div class="step-item">
                                        <div class="step-number">3</div>
                                        <div class="step-content">
                                            <h6>Phone Number ID</h6>
                                            <p>Sayfada gÃ¶rÃ¼nen Phone Number ID'yi alÄ±n (Ã¶rn: 979792258544716)</p>
                                        </div>
                                    </div>
                                    <div class="step-item">
                                        <div class="step-number">4</div>
                                        <div class="step-content">
                                            <h6>BaÄŸlan</h6>
                                            <p>"Meta API ile BaÄŸlan" butonuna tÄ±klayÄ±p bilgileri yapÄ±ÅŸtÄ±rÄ±n</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="help-box mt-4">
                                <h6><i class="bi bi-lightbulb"></i> Meta Developer Console Bilgileri</h6>
                                <ul>
                                    <li><strong>Access Token:</strong> Meta API Testing sayfasÄ±nda "Generate access token" butonuyla alÄ±nÄ±r</li>
                                    <li><strong>Phone Number ID:</strong> Test sayfasÄ±nda gÃ¶sterilen ID (Ã¶rn: 979792258544716)</li>
                                    <li><strong>Test Phone:</strong> Botun kullanacaÄŸÄ± WhatsApp Business numarasÄ±</li>
                                    <li><strong>Token SÃ¼resi:</strong> 60 dakika geÃ§erli, yeni token alabilirsiniz</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Page -->
        <div id="page-dashboard" class="page-content" style="display: none;">
            <div class="page-header">
                <h2><i class="bi bi-speedometer2 me-2"></i>Dashboard</h2>
                <p>Bot performansÄ±nÄ± ve aktiviteleri takip edin</p>
            </div>
            
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="stat-card green">
                        <div class="stat-number" id="statTotal">0</div>
                        <div class="stat-label">Toplam Mesaj</div>
                        <i class="bi bi-chat-dots stat-icon"></i>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card purple">
                        <div class="stat-number" id="statUsers">0</div>
                        <div class="stat-label">Aktif KullanÄ±cÄ±</div>
                        <i class="bi bi-people stat-icon"></i>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card orange">
                        <div class="stat-number" id="statToday">0</div>
                        <div class="stat-label">BugÃ¼n</div>
                        <i class="bi bi-graph-up stat-icon"></i>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card blue">
                        <div class="stat-number" id="statCatalogs">0</div>
                        <div class="stat-label">Katalog GÃ¶nderildi</div>
                        <i class="bi bi-file-pdf stat-icon"></i>
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header">
                            <i class="bi bi-clock-history"></i> Son KonuÅŸmalar
                            <span class="badge bg-success ms-auto">CanlÄ±</span>
                        </div>
                        <div class="card-body p-0" id="dashboardLogs" style="max-height: 400px; overflow-y: auto;">
                            <div class="text-center text-muted p-5">
                                <i class="bi bi-chat-left-dots" style="font-size: 3rem; opacity: 0.3;"></i>
                                <p class="mt-3">HenÃ¼z konuÅŸma yok</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card">
                        <div class="card-header"><i class="bi bi-info-circle"></i> Bot Bilgileri</div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="text-muted small">DURUM</label>
                                <div class="d-flex align-items-center gap-2 mt-1">
                                    <span class="status-dot offline" id="dashStatusDot"></span>
                                    <span id="dashStatusText" class="fw-bold">Ã‡evrimdÄ±ÅŸÄ±</span>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="text-muted small">SON AKTÄ°VÄ°TE</label>
                                <div id="lastActivity" class="fw-bold mt-1">-</div>
                            </div>
                            <div>
                                <label class="text-muted small">VERSÄ°YON</label>
                                <div class="fw-bold mt-1">WhatsApp Bot v2.0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Messages Page -->
        <div id="page-messages" class="page-content" style="display: none;">
            <div class="page-header">
                <h2><i class="bi bi-chat-quote me-2"></i>Mesaj Ä°Ã§erikleri</h2>
                <p>Bot'un gÃ¶ndereceÄŸi mesajlarÄ± buradan dÃ¼zenleyin</p>
            </div>
            
            <div class="help-box">
                <h6><i class="bi bi-info-circle"></i> Bu Sayfa Ne Ä°ÅŸe Yarar?</h6>
                <p>MÃ¼ÅŸterilerinize gÃ¶nderilen tÃ¼m mesajlarÄ± buradan dÃ¼zenleyebilirsiniz. Soldaki listeden bir mesaj seÃ§in, saÄŸda dÃ¼zenleyin ve kaydedin.</p>
                <ul>
                    <li><strong>*yÄ±ldÄ±z iÃ§i*</strong> = <strong>kalÄ±n</strong> yazÄ±</li>
                    <li><strong>_alt Ã§izgi iÃ§i_</strong> = <em>italik</em> yazÄ±</li>
                    <li>Emoji kullanabilirsiniz ğŸŒ´ âœˆï¸ ğŸ’•</li>
                </ul>
            </div>
            
            <div class="row">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header"><i class="bi bi-list"></i> Mesaj Listesi</div>
                        <div class="card-body p-0">
                            <div class="message-list" id="messageList"></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span><i class="bi bi-pencil"></i> <span id="editingTitle">Mesaj DÃ¼zenleme</span></span>
                            <button class="btn btn-whatsapp" id="saveMessageBtn" disabled>
                                <i class="bi bi-check-lg"></i> Kaydet
                            </button>
                        </div>
                        <div class="card-body">
                            <textarea class="form-control message-editor-area" id="messageEditor" 
                                      placeholder="Soldaki listeden dÃ¼zenlemek istediÄŸiniz mesajÄ± seÃ§in..." disabled></textarea>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header"><i class="bi bi-eye"></i> Ã–nizleme</div>
                        <div class="card-body">
                            <div class="phone-preview">
                                <div class="chat-bubble" id="messagePreview">Mesaj Ã¶nizlemesi burada gÃ¶rÃ¼necek...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Flows Page -->
        <div id="page-flows" class="page-content" style="display: none;">
            <div class="page-header">
                <h2><i class="bi bi-diagram-3 me-2"></i>MenÃ¼ & AkÄ±ÅŸlar</h2>
                <p>MÃ¼ÅŸterilerin seÃ§ebileceÄŸi menÃ¼ seÃ§eneklerini yÃ¶netin</p>
            </div>
            
            <div class="help-box">
                <h6><i class="bi bi-info-circle"></i> Bu Sayfa Ne Ä°ÅŸe Yarar?</h6>
                <p>MÃ¼ÅŸteriler "1", "2", "3" gibi rakamlar veya anahtar kelimeler yazdÄ±ÄŸÄ±nda hangi mesajÄ±n gÃ¶nderileceÄŸini buradan ayarlayabilirsiniz.</p>
            </div>
            
            <div class="row">
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span><i class="bi bi-menu-button-wide"></i> Ana MenÃ¼ SeÃ§enekleri</span>
                            <button class="btn btn-sm btn-outline-whatsapp" id="addFlowBtn">
                                <i class="bi bi-plus-lg"></i> Yeni Ekle
                            </button>
                        </div>
                        <div class="card-body" id="flowsList"></div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header"><i class="bi bi-pencil-square"></i> SeÃ§enek DÃ¼zenleme</div>
                        <div class="card-body" id="flowEditor">
                            <div class="text-center text-muted p-4">
                                <i class="bi bi-hand-index" style="font-size: 3rem; opacity: 0.3;"></i>
                                <p class="mt-3">DÃ¼zenlemek iÃ§in soldaki listeden bir seÃ§enek seÃ§in</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header"><i class="bi bi-command"></i> Ã–zel Komutlar</div>
                        <div class="card-body" id="globalCommands">
                            <p class="text-muted">KullanÄ±cÄ±larÄ±n her zaman kullanabileceÄŸi komutlar:</p>
                            <div class="mb-2"><code>MENU</code> â†’ Ana menÃ¼ye dÃ¶ner</div>
                            <div class="mb-2"><code>YARDIM</code> â†’ YardÄ±m mesajÄ± gÃ¶sterir</div>
                            <div><code>GÃ–RÃœÅME</code> â†’ GÃ¶rÃ¼ÅŸme talebi oluÅŸturur</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Catalogs Page -->
        <div id="page-catalogs" class="page-content" style="display: none;">
            <div class="page-header">
                <h2><i class="bi bi-file-pdf me-2"></i>PDF Kataloglar</h2>
                <p>MÃ¼ÅŸterilere gÃ¶nderilen katalog dosyalarÄ±nÄ± yÃ¶netin</p>
            </div>
            
            <div class="help-box">
                <h6><i class="bi bi-info-circle"></i> Bu Sayfa Ne Ä°ÅŸe Yarar?</h6>
                <p>MÃ¼ÅŸterilere otomatik olarak gÃ¶nderilen PDF katalog dosyalarÄ±nÄ± buradan yÃ¶netebilirsiniz. Yeni katalog eklemek iÃ§in aÅŸaÄŸÄ±daki "PDF YÃ¼kle" butonunu kullanÄ±n.</p>
            </div>
            
            <div class="row">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <span><i class="bi bi-folder"></i> Mevcut Kataloglar</span>
                            <label class="btn btn-sm btn-whatsapp mb-0" style="cursor: pointer;">
                                <i class="bi bi-upload"></i> PDF YÃ¼kle
                                <input type="file" id="catalogUpload" accept=".pdf" style="display: none;" multiple>
                            </label>
                        </div>
                        <div class="card-body" id="catalogsList">
                            <div class="text-center text-muted p-4">Kataloglar yÃ¼kleniyor...</div>
                        </div>
                    </div>
                    
                    <!-- Upload Progress -->
                    <div class="card" id="uploadProgressCard" style="display: none;">
                        <div class="card-body">
                            <div class="d-flex align-items-center gap-3">
                                <div class="spinner-border text-success" role="status"></div>
                                <div>
                                    <strong id="uploadFileName">Dosya yÃ¼kleniyor...</strong>
                                    <div class="progress mt-2" style="height: 8px; width: 200px;">
                                        <div class="progress-bar bg-success" id="uploadProgress" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card">
                        <div class="card-header"><i class="bi bi-link-45deg"></i> Katalog EÅŸleÅŸtirme</div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">Phuket Tur KataloÄŸu</label>
                                <select class="form-select" id="catalogPhuket"></select>
                                <div class="form-text">Grup turlarÄ± ve Ã¶zel turlar iÃ§in</div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">BalayÄ± KataloÄŸu</label>
                                <select class="form-select" id="catalogBalayi"></select>
                                <div class="form-text">BalayÄ± tatili seÃ§ildiÄŸinde</div>
                            </div>
                            <button class="btn btn-whatsapp w-100" id="saveCatalogsBtn">
                                <i class="bi bi-check-lg"></i> Kaydet
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="page-settings" class="page-content" style="display: none;">
            <div class="page-header">
                <h2><i class="bi bi-gear me-2"></i>Ayarlar</h2>
                <p>Bot davranÄ±ÅŸÄ±nÄ± ve sistem ayarlarÄ±nÄ± yapÄ±landÄ±rÄ±n</p>
            </div>
            
            <div class="row">
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header"><i class="bi bi-building"></i> Åirket Bilgileri</div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">Åirket AdÄ±</label>
                                <input type="text" class="form-control" id="settingSirketAdi" placeholder="Ã–rn: Phuket TÃ¼rk Ekibi">
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header"><i class="bi bi-clock"></i> Ã‡alÄ±ÅŸma Saatleri</div>
                        <div class="card-body">
                            <div class="help-box mb-3">
                                <p class="mb-0"><i class="bi bi-lightbulb"></i> Ã‡alÄ±ÅŸma saatleri dÄ±ÅŸÄ±nda otomatik mesaj gÃ¶nderilir.</p>
                            </div>
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="settingCalismaSaatiAktif" style="width: 50px; height: 26px;">
                                <label class="form-check-label ms-2">Ã‡alÄ±ÅŸma saati kontrolÃ¼ aktif</label>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <label class="form-label">BaÅŸlangÄ±Ã§</label>
                                    <input type="number" class="form-control" id="settingSaatBaslangic" value="9" min="0" max="23">
                                </div>
                                <div class="col-6">
                                    <label class="form-label">BitiÅŸ</label>
                                    <input type="number" class="form-control" id="settingSaatBitis" value="22" min="0" max="24">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header"><i class="bi bi-sliders"></i> Bot DavranÄ±ÅŸÄ±</div>
                        <div class="card-body">
                            <div class="mb-4">
                                <label class="form-label">YanÄ±t Gecikmesi (ms)</label>
                                <input type="number" class="form-control" id="settingGecikme" value="1000" min="500" max="5000">
                                <div class="form-text">1000 = 1 saniye</div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Oturum Zaman AÅŸÄ±mÄ± (dakika)</label>
                                <input type="number" class="form-control" id="settingZamanAsimi" value="30" min="5" max="120">
                                <div class="form-text">Bu sÃ¼re sonunda konuÅŸma sÄ±fÄ±rlanÄ±r</div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-whatsapp btn-lg w-100" id="saveSettingsBtn">
                        <i class="bi bi-check-lg"></i> TÃ¼m AyarlarÄ± Kaydet
                    </button>
                </div>
            </div>
        </div>

        <!-- Logs Page -->
        <div id="page-logs" class="page-content" style="display: none;">
            <div class="page-header">
                <h2><i class="bi bi-journal-text me-2"></i>KonuÅŸma GeÃ§miÅŸi</h2>
                <p>MÃ¼ÅŸterilerle yapÄ±lan tÃ¼m konuÅŸmalarÄ± gÃ¶rÃ¼ntÃ¼leyin</p>
            </div>
            
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span><i class="bi bi-chat-left-text"></i> Mesaj AkÄ±ÅŸÄ± <span class="badge bg-success">CanlÄ±</span></span>
                    <button class="btn btn-sm btn-outline-danger" id="clearLogsBtn">
                        <i class="bi bi-trash"></i> Temizle
                    </button>
                </div>
                <div class="card-body p-0" id="logsContainer" style="max-height: 600px; overflow-y: auto;">
                    <div class="text-center text-muted p-5">
                        <i class="bi bi-chat-left-dots" style="font-size: 3rem; opacity: 0.3;"></i>
                        <p class="mt-3">HenÃ¼z konuÅŸma yok</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- WhatsApp Business API Page -->
        <div id="page-whatsapp-business" class="page-content" style="display: none;">
            <div class="page-header">
                <h2><i class="bi bi-cloud-check me-2"></i>WhatsApp Business API</h2>
                <p>Meta WhatsApp Business Cloud API yapÄ±landÄ±rmasÄ±</p>
            </div>
            
            <div class="help-box">
                <h6><i class="bi bi-info-circle"></i> WhatsApp Business API Nedir?</h6>
                <p>Meta'nÄ±n resmi WhatsApp Business API'si ile geliÅŸmiÅŸ mesajlaÅŸma Ã¶zellikleri kullanabilirsiniz.</p>
            </div>

            <div class="row">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header"><i class="bi bi-sliders"></i> API YapÄ±landÄ±rmasÄ±</div>
                        <div class="card-body">
                            <div class="form-check form-switch mb-4">
                                <input class="form-check-input" type="checkbox" id="wbaEnabled">
                                <label class="form-check-label fw-bold" for="wbaEnabled">
                                    WhatsApp Business API'yi EtkinleÅŸtir
                                </label>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Phone Number ID</label>
                                <input type="text" class="form-control" id="wbaPhoneNumberId" placeholder="102345678901234">
                                <div class="form-text">WhatsApp Business telefon numarasÄ± ID'si</div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Access Token</label>
                                <input type="password" class="form-control" id="wbaAccessToken" placeholder="EAAG...">
                                <div class="form-text">API Access Token</div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Webhook Verify Token</label>
                                <input type="text" class="form-control" id="wbaWebhookToken" placeholder="my_token">
                                <div class="form-text">Webhook doÄŸrulama token'Ä±</div>
                            </div>

                            <button class="btn btn-whatsapp" id="saveWbaConfigBtn">
                                <i class="bi bi-save"></i> YapÄ±landÄ±rmayÄ± Kaydet
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="toast-container" id="toastContainer"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        // Chrome extension hatalarÄ±nÄ± filtrele
        const originalError = console.error;
        console.error = function(...args) {
            const message = args.join(' ');
            // Chrome extension ve browser internal hatalarÄ±nÄ± filtrele
            if (
                message.includes('listener indicated an asynchronous response') ||
                message.includes('message channel closed') ||
                message.includes('Extension context invalidated') ||
                message.includes('chrome-extension://') ||
                message.includes('moz-extension://')
            ) {
                return; // Bu hatalarÄ± gÃ¶sterme
            }
            originalError.apply(console, args);
        };

        // Promise rejection'larÄ± da filtrele
        window.addEventListener('unhandledrejection', function(event) {
            const message = event.reason?.message || event.reason || '';
            if (
                message.includes('listener indicated an asynchronous response') ||
                message.includes('message channel closed') ||
                message.includes('Extension context invalidated')
            ) {
                event.preventDefault(); // HatayÄ± engelle
                return;
            }
        });
    </script>
    <!-- Socket.io Client Library -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>
